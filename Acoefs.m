function [ AA ] = Acoefs(  eta , h , mi0 , h0 , k , Nm)

a = (mi0*h0+1)/2/h0;
b = (mi0*h0-1)/2/h0;
H = eta+h;

AA(1,1,:) = (8*a*a/15) * H .^3 - (4*a/3) * H .^2 + H;
AA(1,2,:) = (-5*a/3 +b/3 +1/2/h0)*H .^2 +...
    (2*a*a/3 - 2*a*b/15 -a/4/h0) * H .^3 + H;
k0 = k(:,1);
AA(1,3,:) = (mi0/h0 + mi0^2)./H./k0.^4 -1./h0./k0.^2;

AA(2,1,:) = AA(1,2,:);
AA(2,2,:) = (a^2 - (2*a*b)/3 + (b^2)/5 + 1/(3*h0^2) - a/h0 + b/(2*h0))*H.^3 +...
    (-2*a + (2*b)/3 + 1/h0) * H.^2 + H;
AA(2,3,:) = (2*b*mi0)./(H.*k0.^4) + (-1 + H*mi0+h0*mi0-a*H*h0*mi0 + b*h0*(-2+H*mi0)+sech(k0.*H))./h0./k0.^2;
AA(3,1,:) = AA(1,3,:);
AA(3,2,:) = AA(2,3,:);
AA(3,3,:) = H/2 + (-H*mi0^2+mi0)/2./k0.^2;



for n=4:Nm
    kn = k(:,n-2);
    AA(1,n,:) = (2*mi0*a)./H./kn.^4 + (2*a-mi0)./kn.^2;
    AA(2,n,:) = (2*mi0*b)./H./kn.^4 + (1-H*mi0-h0*mi0+a*H*h0*mi0+b*h0*(2-H*mi0)-sec(H.*kn))./(h0*kn.^2);
    AA(n,1,:) = AA(1,n,:);
    AA(n,2,:) = AA(2,n,:);

    AA(n,n,:) = H/2 + (H*mi0^2 - mi0)./2./kn.^2;
end


